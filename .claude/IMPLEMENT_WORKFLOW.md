# Implementation Workflow - Pixel-Perfect Figma to HTML

## Overview

The `/implement` command now **automatically extracts all Figma assets and measurements** before Claude starts implementation, ensuring pixel-perfect accuracy.

## Automated Steps

When you run `/implement`, the script will:

### 1. **Asset Extraction** (Automatic)
- Downloads component screenshot for visual reference
- Identifies and downloads all assets:
  - Logo (PNG)
  - Icons (SVG)
  - Images
- Saves to organized directories:
  ```
  assets/
    ├── logo/logo.png
    ├── icons/
    │   ├── heart.svg
    │   ├── person.svg
    │   ├── cart.svg
    │   └── arrow.svg
    └── images/
  ```

### 2. **Measurement Extraction** (Automatic)
- Fetches raw Figma API data → `figma-data.json`
- Extracts pixel-perfect measurements:
  - Container dimensions
  - Element sizes (width × height)
  - Positions (x, y coordinates)
  - Gaps between elements
  - Colors (from fills)
- Generates readable report → `FIGMA_MEASUREMENTS.md`

### 3. **Claude Implementation** (You guide)
Claude will be instructed to:
- ✅ Use **real assets** from `assets/` (not custom SVGs)
- ✅ Apply **exact measurements** from `FIGMA_MEASUREMENTS.md`
- ✅ Extract **colors** from `figma-data.json`
- ✅ Match **layout positions** precisely (gaps, spacing)
- ✅ Generate pixel-perfect HTML/CSS/JS
- ✅ Create comprehensive Playwright tests
- ✅ Validate visual match ≥98%

## Files Generated

After `/implement` runs, you'll have:

```
your-project/
├── figma-data.json              # Raw Figma API data
├── FIGMA_MEASUREMENTS.md        # Human-readable measurements
├── assets/
│   ├── logo/logo.png
│   └── icons/*.svg
├── figma-screenshots/
│   └── component-1-original.png # Reference screenshot
├── html/component-1.html        # Generated by Claude
├── css/component-1.css          # Generated by Claude
├── js/component-1.js            # Generated by Claude (if needed)
└── tests/component-1.spec.js    # Generated by Claude
```

## Example: Search Bar Implementation

### Before (Manual Guessing):
```css
.search-form {
  gap: 0;  /* ❌ Wrong! */
}
.search-input {
  flex: 1;  /* ❌ Wrong! */
}
.search-button {
  padding: 0 24px;  /* ❌ Wrong! */
}
```

### After (From Extracted Data):
```css
/* From FIGMA_MEASUREMENTS.md:
   - Input: 458px × 40px
   - Gap: 12px
   - Button: 89px × 40px
*/

.search-form {
  gap: 12px;  /* ✅ Exact! */
}
.search-input {
  width: 458px;  /* ✅ Exact! */
}
.search-button {
  width: 89px;  /* ✅ Exact! */
}
```

## Key Improvements

### 1. **No More Guessing**
- Before: "This looks like 2rem gap" → Actually 206px
- After: Exact value extracted from Figma API

### 2. **Real Assets**
- Before: Custom placeholder SVGs
- After: Actual exported assets from Figma

### 3. **Accurate Colors**
- Before: Guessed hex values
- After: Extracted from Figma fills (exact RGB)

### 4. **Precise Positioning**
- Before: Relative positioning with flexbox
- After: Exact pixel positions and gaps

## Usage

### Basic Usage:
```bash
/implement
```
*Automatically extracts assets and measurements from current task's Figma link*

### Switch to Different Task:
```bash
/implement issue-2-header
```
*Switches to task branch and extracts its assets*

## What to Check

After extraction completes, review:

1. **FIGMA_MEASUREMENTS.md** - Verify dimensions make sense
2. **assets/** - Ensure all assets downloaded correctly
3. **figma-data.json** - Check for any API errors

## Troubleshooting

### "Invalid token" error
→ Update `FIGMA_ACCESS_TOKEN` in `.env` with a token that has `file_content:read` scope

### "Could not export asset"
→ Some Figma nodes can't be exported (groups, etc.). Manual extraction may be needed.

### Missing measurements
→ Check `figma-data.json` structure. Complex nested components may need manual extraction.

## Best Practices

1. **Always run /implement first** - Don't manually create HTML before extraction
2. **Trust the measurements** - Use exact pixel values, not approximations
3. **Use real assets** - Link to `assets/` directory, not custom SVGs
4. **Verify visually** - Compare generated HTML with `figma-screenshots/` reference
5. **Run tests** - Ensure ≥98% visual match before proceeding

## Advanced: Manual Asset Extraction

If you need to extract assets separately:

```bash
# From project root
bash .claude/scripts/figma-extractor.sh

# Then call the extraction function
extract_all "https://figma.com/design/..." "component-slug"
```

## Related Commands

- `/init-figma` - Initialize Figma project
- `/breakdown` - Analyze and create tasks
- `/implement` - **Extract assets & implement component** ⭐
- `/to-liquid` - Convert HTML to Liquid

---

**Remember:** The goal is pixel-perfect accuracy. Trust the extracted data over manual guessing!
